import{f as m,s as f}from"./snackbar.16e642ba.js";import{t as h,g as p}from"./throttle.a267e193.js";import{f as b}from"./formValidation.51e98b4e.js";import{c as y}from"./clearSearch.e7eb45cc.js";import{s as k}from"./scrollToEl.c8d0887b.js";function w(t){if(t.getAttribute("data-dynamicFilter")==="true")return;const e=t.options[t.selectedIndex].dataset.filterlink;e&&(window.location.href=e)}b();let c=document.querySelectorAll(".rankings-content__item");const s={},d=document.getElementById("rankings-content"),_={per_page:100,per_mobile_page:25};let r=JSON.parse(d.getAttribute("data-rankingConfig"));r={..._,...r};document.addEventListener("change",t=>{var e,n;if(t.target.matches(".rankings-filters select")&&w(t.target),t.target.getAttribute("data-dynamicFilter")==="true"){const a=t.target.type==="checkbox"?t.target.checked:t.target.value,i=document.getElementById("filterSubdiscipline");if(t.target.id==="filterPublisher"&&(i==null?void 0:i.value.length)){const o=(n=(e=i==null?void 0:i.options[0])==null?void 0:e.dataset)==null?void 0:n.filterlink;o&&window.location.replace(`${o}?publisherId=${a}`);return}u(a,t.target.getAttribute("id")),g(t)}});document.addEventListener("submit",t=>{if(t.target.matches("#searchRanking")){const e=document.getElementById("searchQuery").value.trim();if(!I(e,t))return!1;u(e,"searchQuery"),g(t)}});document.addEventListener("click",t=>{t.target.matches(".rankings-pagination a")&&L(t),t.target.matches("#clearFilter")&&y()});document.addEventListener("scroll",h(E,100));function I(t,e){return t.length>0?!0:(e.preventDefault(),document.getElementById("searchQuery").value=null,e.target.reportValidity(),!1)}function L(t){if(Object.keys(s).length===0)return;t.preventDefault(),document.querySelector(".rankings-pagination").classList.toggle("disabled");const e=t.target.getAttribute("href");m(e,s).then(n=>n.text().then(a=>{const i=p(`${window.location.protocol}//${window.location.hostname}${e}`,"scroll_to");k(document.getElementById(i)),d.innerHTML=a})).catch(()=>{f()}),window.scrollTo(0,0)}function g(t=null){t==null||t.preventDefault(),t==null||t.target.classList.add("loading"),m("//"+location.host+location.pathname,s).then(e=>e.text().then(n=>{d.innerHTML=n,c=document.querySelectorAll(".rankings-content__item"),document.getElementById("clearFilter").classList.add("show")})).catch(()=>{f()}).finally(()=>{t==null||t.target.classList.remove("loading")})}function E(){if(window.innerWidth>768||c.length===0)return;const t=document.getElementById("rankingItems"),e=parseInt(t.getAttribute("data-items"));if(e===r.per_page)return;const n=t.getBoundingClientRect(),a=n.height*.8;if(n.y>0||Math.abs(n.y)<a)return;let o=r.per_mobile_page;e>r.per_mobile_page&&(o=e-r.per_mobile_page);for(let l=o;l<e+r.per_mobile_page;l++)c[l]&&c[l].classList.add("show");e===r.per_page-r.per_mobile_page&&document.getElementById("rankingPagination").classList.add("show"),t.setAttribute("data-items",(e+r.per_mobile_page).toString())}function u(t,e=null){B(t)?s[e]=t:delete s[e]}function B(t){return typeof t=="boolean"?t:isNaN(t)?typeof t=="string"&&t.length>=2:!0}window.addEventListener("DOMContentLoaded",()=>{const e=new URLSearchParams(window.location.search).get("publisherId");e&&(document.getElementById("filterPublisher").value=e,u(e,"filterPublisher"),g())});
